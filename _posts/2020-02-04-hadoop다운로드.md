---
title : "Apache Hadoop 설치하기(수정중)"
author : "금주"
#categories : - Project
date: "2020-02-04"
---

# Hadoop 의 구축 방법
---
* 단독 작업 모드 (Stand-Alone Operation)
* 가상 분산 모드 (Pseudo-Distributed Operation)
* 완전 분산 모드 (Fully-Distributed Operation)

나는 가상 분산모드 할거임


~ 순서 ~

1. 하둡 설치하기
2. 하둡 서버 구축
3. 하둡 스파크 연동

# 하둡(Hadoop) 설치하기
---



{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/1.PNG" alt=""> {% endraw %}

영상에서는 위의 사진과 같은  3대의 가상머신을 만들었다.
네임노드 : 파일을 쪼개고 쪼개진 파일이 어떤 데이터 노드에 저장되어져 있는지 기억하는 컴퓨터
데이터 노드 : 실제 사용자가 업로드한 데이터를 쪼개진 형태로 보관하고 있는 컴퓨터



파일의 이름이나 경로는 네임노드에 저장되고 , 실제 데이터는 데이터 노드에 분산되어 저장되어져 있음

하둡은 자바로 개발이 되었기 때문에 java가 가장 접근성이 좋지만 php, python 으로도 제어할 수 있다.

하둡은 큰 데이터를 처리하기 위해 만들어 졌기 때문에 작은파일도 병렬처리로 처리를 하기 때문에 시간이 오래걸린다.


나는 가상머신 2개를 이용해서 분산 컴퓨팅 환경을 구축하려고 한다.
데이터가 많이 필요하지 않을 것 같아 2개만 사용할 예정 ( master-slave )

아 그리고 가상머신은 virtual box 를 사용할 것이다.

## 서버 환경 구성하기

ssh 다운로드가 안받아져 있거나 ssh 대해 모르는 사람들(나)이 참고했으면 하는 블로그 글
<http://magic.wickedmiso.com/101>

1. user / usergroup 생성

모든 서버에 haoop 그룹과 유저를 생성하고 권한을 부여해 준다.


> sudo addgroup hadoop <br>
sudo adduser --ingroup hadoop hduser



{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/2.PNG" alt=""> {% endraw %}

> sudo visudo

> hduser ALL=(ALL:ALL) ALL

{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/3.PNG" alt=""> {% endraw %}

sudoers file 에 hduser 을 추가한다.

> su -hduser

{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/4.PNG" alt=""> {% endraw %}

hduser 로 로그인을 한다.

2. ssh 설정

hadoop 은 분산 처리시에 서버들간의 ssh 통신을 자동으로 수행하기 때문에 이를 암호없이 접속할 수 있도록 master 서버에서 공개키를 생성하고 생성된 키를 각 서버들에 배표해준다.


>sudo -s

관리자 권환 획득

> vi /etc/ssh/sshd_confing

sshd 파일을 수정
하는데 문제가 발생 E309 E325 ERROR 해결하는데 시간이 꽤 걸릴 것 같다.

먼저 E325 의 오류 해결 : <https://kissgoods.tistory.com/61>
내가 그냥 종료시켰더니 임시파일이 저장되었던 것 같다.
{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/5.PNG" alt=""> {% endraw %}

왼쪽 사진 경로에 있는 스왑파일을 오른쪽처럼 삭제했음 !

E309 오류는 파일 경로를 잘못 입력해서 거기에 스왑파일 없다는 메시지 였음


{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/6.PNG" alt=""> {% endraw %}

참고로 종료 :wq 입력하면 종료됨 ! (진짜 많이 헤맷다 ^^ ;ㅋ)



>$ mkdir ~/.ssh <br>
$ chmod 700 ~/.ssh <br>
$ ssh-keygen -t rsa -P "" <br> -> 그냥 엔터 치기
< https://itzone.tistory.com/694 >


>$ cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys

공개키를 생성한 뒤


>$ ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu1
$ ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu2
$ ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu3

공개키를 각 서버에 배포한다.
나는 slave 하나 만들었기 때문에
>ssh-copy-id -i~/.ssh/id_rsa.pub slave

접속 테스트
> ssh slave

* ssh 는 조금 더 알아봐야할 것 같음


3. java 설치

directory를 생성해준다.
> $ sudo mkdir /opt/jdk
$ cd /opt

opt 폴더에 java를 다운로드 받아야하는데, java 라이선스 정책변경에 따라서 <b>"$ sudo wget --header "Cookie: oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u111-b14/jdk-8u111-linux-x64.tar.gz" "</b> 로는 다운로드가 안되게 바뀐 것 같다.

그래서 아래의 블로그를 참고하여 다운로드 받았음.


<https://m.blog.naver.com/PostView.nhn?blogId=love_tolty&logNo=221585458347&proxyReferer=https%3A%2F%2Fwww.google.com%2F>

OpenJDK 8 설치
> sudo apt-get install openjdk-8-jdk

참고로 다운받는 시간이 좀 걸린다 ㅠㅠ 성격 매우 급한 편 ,,

{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/7.PNG" alt=""> {% endraw %}
[jdk 다운로드가 완료된 모습]

{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/8.PNG" alt=""> {% endraw %}

자바 버전을 확인해 보니 잘 설치된 것 같다.


4. locale 확인 (옵션)

모든 서버의 locale 정보를 확인해보고 en_US.UTF-8 혹은 ko_KR.UTF-8 이 아닌 경우에만 변경을 해주면 됩니다.
일반적으로는 변경할 필요가 없으니 옵션사항으로 생각하시고 skip 하시면 되겠습니다.
출처: https://daeson.tistory.com/277?category=679387 [대소니]

그렇다고 함

{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/9.PNG" alt=""> {% endraw %}

나는 할 필요 없어서 넘어가겠음
해야할 분들은 저 블로그 가서 따라하세용 !

5. hosts 파일 수정

> sudo vi /etc/hosts

확인

> cat /etc/hosts

6. hostname 변경

> sudo vi /etc/hostname
이름 입력후 엔터

변경사항 적용하기

> sudo /bin/hostname -F /etc/hostname


## 본격 하둡 설치하기

https://www.codementor.io/@hermanmorgan/how-to-install-hadoop-2-7-in-ubuntu-uu4ochaeu
여기서 링크에 걸려있는 하둡 .tar.gz 파일 다운로드 한 뒤, 압축 풀어줌

나는 window d드라이브 파일을 공유해놔서 그 폴더에 넣은 뒤 끌어왔다.

/home 에 압축 풀어주고

> mv hadoop-2.7.1 hadoop

명령어를 통해 hadoop 이라는 폴더로 이름 바꿔줬음

{% raw %} <img src="https://bcloved.github.io/assets/images/20200204ApacheHadoop/10.PNG" alt=""> {% endraw %}


ㅎr . . . . . .. .. . ... . . .가상머신의 치명적 오류로 다시 처음부터 해야됨 ㅎㅎ ;;
후욱 우후욱욱ㅇ

<https://riothaid.tistory.com/178>


---
참고
<https://daeson.tistory.com/277?category=679387>
<https://bisn.tistory.com/9>
